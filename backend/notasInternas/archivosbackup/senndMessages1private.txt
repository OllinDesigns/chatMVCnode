// GUARDAR BIEN ESTA FUNCION, SIRVE PARA PRIVATE MESSAGES
// export const sendMessage1 = async (req: Request, res: Response) => {
//   console.log("sendMessage1 function is called");
//   try {
//     const recipientUserId = req.params.userId;
//     const { text } = req.body; // Remove author from the destructuring

//     const user = req.user as IUser | undefined; // Use IUser and allow undefined

//     if (!user) {
//       return res.status(401).json({ error: "User not authenticated" });
//     }

//     // Create a new message with the authenticated user as the author
//     const newMessage = new Message({
//       recipientUser: recipientUserId,
//       author: user._id, // Automatically set the authenticated user's ID
//       text,
//     });

//     console.log("New message:", newMessage);

//     await newMessage.save();

//     const io = getIo();

//     io.emit("new-message", newMessage);

//     return res.status(201).json(newMessage);
//   } catch (error) {
//     console.error("Error sending a message:", error);
//     return res.status(500).json({ error: "Internal server error" });
//   }
// };